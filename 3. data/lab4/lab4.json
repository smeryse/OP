{
    "lab": {
      "number": 4,
      "discipline": "Операционные системы",
      "theme": "Управление пользователями и группами"
    },
    "goals": "Изучить механизмы управления пользователями и группами в ОС Linux, освоить работу с файлами /etc/passwd, /etc/shadow, /etc/group, а также команды useradd, usermod, userdel, groupadd, groupdel, gpasswd, chage и другие.",
    "procedure": [
      {
        "text": "Создали пользователей user1 и user2 с домашними каталогами и оболочкой /bin/bash с помощью команды sudo useradd -m -s /bin/bash user1 и аналогично для user2. Проверили их появление в файле /etc/passwd (Рис. 1).",
        "images": [
          {
            "number": 1,
            "src": "images/1.png",
            "caption": "Создание пользователей user1 и user2 и проверка в /etc/passwd"
          }
        ]
      },
      {
        "text": "Назначили пароли для пользователей user1 и user2 командой sudo passwd user1 и sudo passwd user2 (Рис. 2).",
        "images": [
          {
            "number": 2,
            "src": "images/2.png",
            "caption": "Установка паролей для user1 и user2"
          }
        ]
      },
      {
        "text": "С помощью команды sudo chage установили для обоих пользователей параметры срока действия пароля: минимальный срок 1 день, максимальный 30 дней, предупреждение за 3 дня, период неактивности 3 дня. Проверили настройки командой sudo chage -l user1 (Рис. 3).",
        "images": [
          {
            "number": 3,
            "src": "images/3.png",
            "caption": "Изменение параметров пароля для user1 и проверка"
          }
        ]
      },
      {
        "text": "Создали группы group1, group2, group3 командами sudo groupadd group1, sudo groupadd group2, sudo groupadd group3. Назначили пароль для группы group3 командой sudo gpasswd group3 и сделали пользователя user1 администратором этой группы: sudo gpasswd -A user1 group3 (Рис. 4).",
        "images": [
          {
            "number": 4,
            "src": "images/4.png",
            "caption": "Создание групп и настройка пароля и администратора для group3"
          }
        ]
      },
      {
        "text": "Добавили пользователей user1 и user2 в группы group1 и group2 с помощью команды sudo usermod -a -G group1,group2 user1 и аналогично для user2. Проверили членство в группах командой groups user1 (Рис. 5).",
        "images": [
          {
            "number": 5,
            "src": "images/5.png",
            "caption": "Добавление пользователей в дополнительные группы и проверка"
          }
        ]
      },
      {
        "text": "Вошли в систему под пользователем user2 (например, через виртуальную консоль или su - user2). Выполнили команду newgrp group3, ввели пароль группы и убедились, что user2 временно получил права группы group3. После выхода командой exit членство в group3 исчезло (Рис. 6).",
        "images": [
          {
            "number": 6,
            "src": "images/6.png",
            "caption": "Вход под user2, получение прав группы group3 через newgrp"
          }
        ]
      },
      {
        "text": "Вошли под пользователем user1 и добавили пользователя user2 в группу group3 на постоянной основе: sudo usermod -a -G group3 user2. Проверили, что user2 теперь состоит в group3 (Рис. 7).",
        "images": [
          {
            "number": 7,
            "src": "images/7.png",
            "caption": "Добавление user2 в группу group3 под администратором user1"
          }
        ]
      },
      {
        "text": "Заблокировали пользователя user2 командой sudo usermod -L user2. Попытка входа под user2 подтвердила блокировку (Рис. 8).",
        "images": [
          {
            "number": 8,
            "src": "images/8.png",
            "caption": "Блокировка пользователя user2 и проверка входа"
          }
        ]
      },
      {
        "text": "Принудительно установили для пользователя user1 смену пароля при следующем входе командой sudo chage -d 0 user1. Затем вошли под user1, система потребовала сменить пароль, что и было выполнено (Рис. 9).",
        "images": [
          {
            "number": 9,
            "src": "images/9.png",
            "caption": "Принудительная смена пароля для user1 при входе"
          }
        ]
      },
      {
        "text": "Изменили имя пользователя user2 на user3 командой sudo usermod -l user3 user2, а затем разблокировали его: sudo usermod -U user3. Выполнили вход под новым именем user3 для проверки (Рис. 10).",
        "images": [
          {
            "number": 10,
            "src": "images/10.png",
            "caption": "Переименование user2 в user3 и разблокировка"
          }
        ]
      },
      {
        "text": "Перенесли домашние каталоги пользователей user1 и user3 в каталог /mnt/home. Для этого создали /mnt/home, скопировали содержимое cp -rp /home/user1 /mnt/home/ (и аналогично для user3), затем изменили путь в файлах /etc/passwd с помощью usermod -d /mnt/home/user1 user1 и usermod -d /mnt/home/user3 user3. Проверили, что новые домашние каталоги содержат все файлы (Рис. 11).",
        "images": [
          {
            "number": 11,
            "src": "images/11.png",
            "caption": "Перенос домашних каталогов в /mnt/home и проверка"
          }
        ]
      },
      {
        "text": "Удалили группы group1, group2, group3 командами sudo groupdel group1, sudo groupdel group2, sudo groupdel group3. Проверили отсутствие групп в /etc/group (Рис. 12).",
        "images": [
          {
            "number": 12,
            "src": "images/12.png",
            "caption": "Удаление групп group1, group2, group3"
          }
        ]
      },
      {
        "text": "Удалили пользователей user1 и user3 вместе с их домашними каталогами с помощью sudo userdel -r user1 и sudo userdel -r user3. Убедились, что учетные записи и каталоги удалены (Рис. 13).",
        "images": [
          {
            "number": 13,
            "src": "images/13.png",
            "caption": "Удаление пользователей user1 и user3 с домашними каталогами"
          }
        ]
      }
    ],
    "questions": [
      {
        "question": "Назовите четыре файла, в которых содержится информация о пользователях и группах?",
        "answer": "Информация о пользователях и группах в Linux хранится в следующих файлах: /etc/passwd (учетные записи пользователей), /etc/shadow (хеши паролей пользователей), /etc/group (учетные записи групп), /etc/gshadow (пароли групп и администраторы групп)."
      },
      {
        "question": "Как называется файл бекапа для /etc/shadow?",
        "answer": "Резервная копия файла /etc/shadow называется /etc/shadow– (с дефисом в конце). Аналогичные резервные копии существуют для /etc/passwd–, /etc/group– и /etc/gshadow–."
      },
      {
        "question": "Что означает «x» в поле пароля в файле /etc/passwd?",
        "answer": "Символ «x» в поле пароля файла /etc/passwd означает, что настоящий хеш пароля хранится в защищенном файле /etc/shadow. Если вместо «x» стоит «!», это указывает на то, что пароль заблокирован и интерактивный вход запрещен."
      },
      {
        "question": "В каком файле хранятся настройки диапазонов UID, GID?",
        "answer": "Настройки диапазонов UID и GID определяются в файле /etc/login.defs. В нем задаются переменные UID_MIN, UID_MAX, GID_MIN, GID_MAX, а также диапазоны для системных учетных записей."
      },
      {
        "question": "Что делает команда useradd -D?",
        "answer": "Команда useradd -D выводит текущие значения по умолчанию, используемые при создании новых пользователей (например, домашний каталог, оболочку, шаблонную директорию и т.д.). Без параметров она отображает настройки, а с дополнительными опциями позволяет их изменять."
      },
      {
        "question": "Какой UID присвоится первому созданному пользователю в системе?",
        "answer": "В большинстве дистрибутивов Linux, включая Astra Linux, первому обычному пользователю присваивается UID = 1000 (минимальное значение для обычных пользователей, заданное в /etc/login.defs). В системах с уже созданными пользователями следующий свободный UID будет 1001 и т.д."
      },
      {
        "question": "Какие две команды могут быть использованы для блокировки и разблокировки пользователя?",
        "answer": "Для блокировки пользователя можно использовать команды usermod -L (или passwd -l), а для разблокировки — usermod -U (или passwd -u). Также блокировку можно выполнить, установив срок действия учетной записи в прошлом с помощью chage или usermod --expiredate."
      },
      {
        "question": "Как заставить пользователя iivanov принудительно сменить свой пароль при следующем входе?",
        "answer": "Для принудительной смены пароля при следующем входе используется команда chage -d 0 iivanov. Она устанавливает дату последнего изменения пароля в 0 (эпоха Unix), что принуждает систему потребовать смену пароля при следующей аутентификации."
      },
      {
        "question": "Что делает команда faillog -u iivanov -r?",
        "answer": "Команда faillog -u iivanov -r сбрасывает (обнуляет) счетчики неудачных попыток входа для указанного пользователя iivanov. Это может быть полезно после временной блокировки учетной записи из-за превышения лимита неудачных входов."
      }
    ],
    "conclusion": "В ходе выполнения лабораторной работы были изучены основные принципы управления пользователями и группами в операционной системе Linux. Освоены команды useradd, usermod, userdel, groupadd, groupdel, gpasswd, chage, а также получены навыки редактирования параметров учетных записей, управления сроками действия паролей, блокировки и разблокировки пользователей, изменения имени и переноса домашних каталогов. Все практические задания выполнены в полном объеме, что позволило закрепить теоретические знания и приобрести практические навыки администрирования пользователей и групп."
  }